"0","plottexmex <- function (x, plots = ""gpd"", main = """", plotnum=NULL, ...) {"
"0","  if (casefold(plots) == ""gpd"") {"
"0","      which <- 1"
"0","  }"
"0","  else {"
"0","      which <- 2"
"0","  }"
"0","  d2 <- dim(x$boot[[1]][[which]])"
"0","  pointEst <- x$simpleDep"
"0","  condVar <- names(x$simpleMar$data)[x$which]"
"0","  margins <- x$margins"
"0","  x <- x$boot"
"0","  co <- unlist(lapply(x, function(z, wh) z[[wh]], wh = which))"
"0","  co <- array(co, dim = c(d2[1], d2[2], length(co)/prod(d2)))"
"0","  lco <- list(length = prod(d2))"
"0","  for (i in 1:d2[2]) {"
"0","      for (j in 1:d2[1]) {"
"0","          lco[[j + d2[1] * (i - 1)]] <- co[j, i, ]"
"0","      }"
"0","  }"
"0","  cn <- colnames(x[[1]][[which]])"
"0","  rn <- rownames(x[[1]][[which]])"
"0","  if (which == 2) {"
"0","      cn <- paste(cn, ""|"", condVar)"
"0","  }"
"0","  labs <- paste(rep(rn, length(cn)), rep(cn, each = switch(which, "
"0","      2, 6)), sep = ""  "")"
"0","  fun <- function(X, z, label, ...) {"
"0","      hist(z[[X]], prob = TRUE, xlab = label[X], main = main, "
"0","          ...)"
"0","      lines(density(z[[X]], n = 100))"
"0","      invisible()"
"0","  }"
"0","  if (which == 1) {"
"0","      if(is.null(plotnum)){"
"0","        plotnum <- 1:d2[2]"
"0","      }"
"0","      lapply(plotnum, fun, z = lco, label = labs, ...)"
"0","  }"
"0","  if (which == 2) {"
"0","      fun <- function(X, z, label, ...) {"
"0","          offset <- (X - 1) * 6"
"0","          plot(lco[[offset + 1]], lco[[offset + 2]], xlab = labs[offset + "
"0","              1], ylab = labs[offset + 2], main = main, ...)"
"0","          points(pointEst[1, X], pointEst[2, X], pch = ""@"", "
"0","              col = 2)"
"0","          if (margins[[1]] == ""gumbel"") {"
"0","              plot(lco[[offset + 3]], lco[[offset + 4]], xlab = labs[offset + "
"0","                3], ylab = labs[offset + 4], main = main, ...)"
"0","              points(pointEst[3, X], pointEst[4, X], pch = ""@"", "
"0","                col = 2)"
"0","          }"
"0","      }"
"0","      if(is.null(plotnum)){"
"0","        plotnum <- 1:d2[2]"
"0","      }"
"0","      lapply(plotnum, fun, z = lco, label = labs, ...)"
"0","  }"
"0","  invisible()"
"0","}"
"0",""
"0",""
"0","plotpredmex <- function(x, pch = c(1, 3, 20), col = c(2, 8, 3), cex = c(1, "
"0","    1, 1), ask = TRUE, plotnum=NULL, ...){"
"0","  d <- dim(x$data$simulated)[[2]] - 1"
"0","  if (prod(par(""mfrow"")) < d) {"
"0","      if (ask) {"
"0","          op <- par(ask = TRUE)"
"0","          on.exit(par(op))"
"0","      }"
"0","  }"
"0","  xdat <- x$data$real[, 1]"
"0","  upts <- seq(from = 0.001, to = 1 - 1e-04, len = 100)"
"0","  xpts <- texmex:::revTransform(upts, data = x$data$real[, 1],"
"0","                                qu = mean(x$data$real[, 1] < x$mth[1]),"
"0","                                th = x$mth[1],"
"0","                                sigma = x$gpd.coef[3, 1],"
"0","                                xi = x$gpd.coef[4, 1])"
"0","  if(is.null(plotnum)){"
"0","    plotnum <- 2:(dim(x$data$real)[[2]])"
"0","  }"
"0","  for (i in plotnum) {"
"0","      ydat <- x$data$real[, i]"
"0","      xlimits <- range(xdat, x$data$simulated[, 1])"
"0","      ylimits <- range(ydat, x$data$simulated[, i])"
"0","      plot(xdat, ydat, xlim = xlimits, ylim = ylimits,"
"0","          xlab = names(x$data$simulated)[1], "
"0","          ylab = names(x$data$simulated)[i], type = ""n"", "
"0","          ...)"
"0","      points(x$data$simulated[x$data$CondLargest, 1],"
"0","             x$data$simulated[x$data$CondLargest, i],"
"0","             col = col[3], pch = pch[3], cex = cex[3])"
"0","      points(x$data$simulated[!x$data$CondLargest, 1],"
"0","             x$data$simulated[!x$data$CondLargest, i],"
"0","             col = col[2], pch = pch[2], cex = cex[2])"
"0","      points(xdat, ydat, pch = pch[1], col = col[1], cex = cex[1])"
"0","      abline(v = x$data$pth, lty = 2, col = 3)"
"0","      ypts <- texmex:::revTransform(upts, data = x$data$real[, i],"
"0","                           qu = mean(x$data$real[, i] < x$mth[i]),"
"0","                           th = x$mth[i],"
"0","                           sigma = x$gpd.coef[3, i],"
"0","                           xi = x$gpd.coef[4, i])"
"0","      lines(xpts, ypts, col = 3)"
"0","  }"
"0","  invisible()"
"0","}"
